FROM debian:{tag}

# use mirrors.ocf.berkeley.edu
RUN sed -i 's/httpredir\.debian\.org/mirrors.ocf.berkeley.edu/g' /etc/apt/sources.list
RUN sed -i 's/security\.debian\.org/mirrors.ocf.berkeley.edu\/debian-security/g' /etc/apt/sources.list

RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install --no-install-recommends -y \
            build-essential \
            curl \
            devscripts \
            equivs \
            git \
            htop \
            net-tools \
            pv \
            pwgen \
            python-dev \
            python-pip \
            python-virtualenv \
            python3-dev \
            python3-pip \
            python3-virtualenv \  # no:wheezy
            screen \
            sudo \
            tmux \
            unzip \
            vim \
            wget \
            zip \
            zsh \
        && rm -rf /var/lib/apt/lists/*

# add ocf apt repo
RUN [ "{tag}" = "jessie" ] && \
    curl https://apt.ocf.berkeley.edu/pubkey.gpg | apt-key add - && \
    echo 'deb http://apt/ {tag} main' >> /etc/apt/sources.list

# add deb-src entries
RUN sed 's/^deb /deb-src /' /etc/apt/sources.list >> /etc/apt/sources.list
